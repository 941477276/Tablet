/*
 Tablet
 Tablet是一个基于canvas的在线画板，内置精简版jQuery，无其他依赖，传统网站或vue、react、angular等单页面应用皆可使用！兼容各种移动设备！
 github: https://github.com/941477276/Tablet
*/
(function(X){if("function"===typeof define&&define.amd)define(X);else if("object"===typeof module&&module.exports)module.exports=X(require());else{window.Tablet=X();try{"function"===typeof define&&define(function(Y){return X(Y())})}catch(Y){console.log(Y)}}})(function(){function X(c,d,k,u){this.ctx=c;this.ctxBack=d;this.lineConfig=k||{};this.bgConfig=u||{};this.points=[]}function Y(c){this.tablet=c.tablet;this.type=c.type;this.linesIndex="undefined"===typeof c.linesIndex?-1:c.linesIndex;this.lines=
  [].concat(c.lines);this.lineConfig=c.lineConfig?P.extend({},c.lineConfig):null;this.bgConfig=c.bgConfig?P.extend({},c.bgConfig):null}function J(c,d){this._init(c,d);this._ctxInit()}var P=window.jquip;window.jquip||(window.jquip=function(){function c(a,b){for(var e,f=0,g=ka.length;g>f;f++)if(ka[f].apply(this,arguments))return this;return a?O(a)?(sa?a():la.push(a),this):W(a)?this.make(a):a.nodeType||h(a)?this.make([a]):"body"==a&&!b&&I.body?(this.context=a.context,this[0]=I.body,this.length=1,this.selector=
  a,this):void 0!==a.selector?(this.context=a.context,this.selector=a.selector,this.make(a)):(a=Q(a)&&"<"===a.charAt(0)?(e=Ma.exec(a))?[I.createElement(e[1])]:B(a).childNodes:C(this.selector=a,b),this.make(a),q(b)&&this.attr(b),this):this}function d(a,b){return new c(a,b)}function k(a){return!a||!a.parentNode||11==a.parentNode.nodeType}function u(a,b,e){if(b=b||0,O(b))return N(a,function(g,l){return!!b.call(g,l,g)===e});if(b.nodeType)return N(a,function(g){return g===b===e});if(Q(b)){var f=":"==b.charAt(0)&&
  d.Expr[b.substring(1)];return N(a,function(g){var l,t=g.parentNode,E=!t;return E&&(t=Na,t.appendChild(g)),l=f?f(g):g.parentNode&&0<=n(C(b,g.parentNode),g),E&&t.removeChild(g),l})}return N(a,function(g){return 0<=n(b,g)===e})}function w(a,b,e){var f=a[ta];return T(e)?(f||(f=a[ta]=ua++),(fa[f]||(fa[f]={}))[b]=e):f&&fa[f]&&(b?fa[f][b]:fa[f])}function r(a,b){b=" "+b+" ";for(var e=0,f=a.length;f>e;e++){var g=a[e],l=b;if(1===g.nodeType&&-1<(" "+g.className+" ").replace(va," ").indexOf(l))return!0}return!1}
  function x(a,b,e){b=b||I;e=e||[];1==b.nodeType&&a(b)&&e.push(b);b=b.childNodes;for(var f=0,g=b.length;g>f;f++){var l=b[f];1==l.nodeType&&x(a,l,e)}return e}function C(a,b,e){if(a&&Q(a)){b instanceof d&&(b=b[0]);b=b||I;e=e||d.query;var f,g=a.substring(1);return Oa.test(a)&&b===I?(f=I.getElementById(g))?[f]:[]:y(Pa.test(a)&&b.getElementsByClassName?b.getElementsByClassName(g):Qa.test(a)?b.getElementsByTagName(a):e(a,b))}return 1==a.nodeType||9==a.nodeType?[a]:[]}function D(a,b,e){var f,g=I.head||I.getElementsByTagName("head")[0]||
    ma,l=I.createElement("script");e&&(l.async="async");l.onreadystatechange=function(){(f=l.readyState)&&"loaded"!=f&&"complete"!=f||(l.onload=l.onreadystatechange=null,g&&l.parentNode&&g.removeChild(l),l=void 0,b&&b())};l.onload=b;l.src=a;g.insertBefore(l,g.firstChild)}function L(){da.console&&da.console.warn(arguments)}function F(a,b,e){if(null!=a)if(wa&&a.forEach===wa)a.forEach(b,e);else if(a.length===+a.length)for(var f=0,g=a.length;g>f&&!(f in a&&b.call(e,a[f],f,a)===xa);f++);else for(f in a)if(ha.call(a,
    f)&&b.call(e,a[f],f,a)===xa)break}function U(a,b){if(a&&a.getAttribute&&b)return a=a.hasAttribute&&a.hasAttribute(b)?a.getAttribute(b):a[b],null===a?void 0:a}function H(a,b){return T(a)?d(b).filter(a):d(b)}function n(a,b){if(null==a)return-1;var e;if(ya&&a.indexOf===ya)return a.indexOf(b);var f=0;for(e=a.length;e>f;f++)if(a[f]===b)return f;return-1}function v(a,b,e){var f=[];for(a=a[b];a&&9!==a.nodeType&&(void 0===e||1!==a.nodeType||!d(a).is(e));)1===a.nodeType&&f.push(a),a=a[b];return f}function A(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b,e){b=b||1;for(var f=0;a&&(1!==a.nodeType||++f!==b);a=a[e]);return a}function R(a,b){for(var e=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&e.push(a);return e}function N(a,b,e){var f=[];e=!!e;for(var g=0,l=a.length;l>g;g++){var t=!!b(a[g],g);e!==t&&f.push(a[g])}return f}function M(a,b,e){var f,g=[],l=0,t=a.length;if(a instanceof d||"number"==typeof t&&(0<t&&a[0]&&a[t-1]||0===t||W(a)))for(;t>l;l++){var E=b(a[l],l,e);null!=E&&(g[g.length]=E)}else for(f in a)E=b(a[f],f,e),null!=E&&(g[g.length]=E);return g.concat.apply([],
    g)}function K(a,b,e){return a?w(a,b,e)||V(a)["data-"+b]:{}}function V(a){var b={};if(1==a.nodeType){var e=0;a=a.attributes;for(var f=a.length;f>e;e++)b[a.item(e).nodeName]=a.item(e).nodeValue}return b}function Z(a){return null==a?String(a):za[Ra.call(a)]||"object"}function T(a){return void 0!==a}function Q(a){return"string"==typeof a}function O(a){return"function"==typeof a||"function"===Z(a)}function W(a){return"array"===Z(a)}function h(a){return a&&"object"==typeof a&&"setInterval"in a}function q(a){if(!a||
    "object"!==Z(a)||a.nodeType||h(a))return!1;try{if(a.constructor&&!ha.call(a,"constructor")&&!ha.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(var b in a);return void 0===b||ha.call(a,b)}function m(a,b){var e=a.length,f=0;if("number"==typeof b.length)for(var g=b.length;g>f;f++)a[e++]=b[f];else for(;void 0!==b[f];)a[e++]=b[f++];return a.length=e,a}function p(){var a,b,e,f,g=arguments,l=g[0]||{},t=1,E=g.length,aa=!1;"boolean"==typeof l&&(aa=l,l=g[1]||{},t=2);"object"==
  typeof l||O(l)||(l={});for(E===t&&(l=this,--t);E>t;t++)if(null!=(a=g[t]))for(b in a){var ea=l[b],ba=a[b];l!==ba&&(aa&&ba&&(q(ba)||(e=W(ba)))?(e?(e=!1,f=ea&&W(ea)?ea:[]):f=ea&&q(ea)?ea:{},l[b]=p(aa,f,ba)):void 0!==ba&&(l[b]=ba))}return l}function y(a,b){b=b||[];if(null!=a){var e=Z(a);null==a.length||"string"==e||"function"==e||"regexp"===e||h(a)?Aa.call(b,a):m(b,a)}return b}function B(a,b,e){b=b||I||b.ownerDocument||b[0]&&b[0].ownerDocument||I;e=e||b.createDocumentFragment();if(!Q(a)&&"number"==typeof a.length){var f=
    e,g,l,t=[];for(g=0;null!=(l=a[g]);g++)Q(l)&&(l=S(l,b)),l.nodeType?t.push(l):t=m(t,l);if(f)for(g=0;g<t.length;g++)t[g].nodeType&&f.appendChild(t[g]);return t&&e}for(a=S(a);a.firstChild;)e.appendChild(a.firstChild);return e}function S(a,b){b=(b||I).createElement("div");var e=(Sa.exec(a)||["",""])[1].toLowerCase();e=Ba[e]||Ba._default;var f=e[0];for(b.innerHTML=e[1]+a+e[2];f--;)b=b.lastChild;return b}function G(a){if(na&&(ia=Ta,a.sort(na),ia))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);
    return a}function oa(){if(!I.body)return null;var a=I.createElement("div");I.body.appendChild(a);a.style.width="20px";a.style.padding="10px";var b=a.offsetWidth;return I.body.removeChild(a),40==b}function Ca(a,b){Da.push({url:a,cb:b})}function Ea(){F(la,function(a){a()});sa=!0}var sa,pa,na,da=window,I=document,ma=I.documentElement,la=[],Da=[],Ua=/Until$/,Va=/,/,Wa=/^(?:parents|prevUntil|prevAll)/,Sa=/<([\w:]+)/,va=/[\n\t\r]/g,Qa=/^[\w-]+$/,Oa=/^#[\w-]+$/,Pa=/^\.[\w-]+$/,Fa=/\s+/,Xa=/\d/,Ya=/\r\n/g,
    Ma=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,Ga=/\r?\n/g,Za=/^(?:select|textarea)/i,$a=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Ha=String.prototype.trim,Ia=/^\s+/,Ja=/\s+$/,ab={children:!0,contents:!0,next:!0,prev:!0},Ra=Object.prototype.toString,za={},ia=!1,Ta=!0,Ba={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,
        "<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},xa={},z=Array.prototype,ha=Object.prototype.hasOwnProperty,ca=z.slice,Aa=z.push,Ka=z.indexOf,wa=z.forEach,La=z.filter,ya=z.indexOf,ta="jq-"+ +new Date,Na=I.createElement("p");/\S/.test(" ")&&(Ia=/^[\s\xA0]+/,Ja=/[\s\xA0]+$/);var ka=[],ua=1,fa={_id:0},qa={};z=c.prototype=d.prototype=d.fn={constructor:d,selector:"",length:0,dm:function(a,b,e){var f,
      g,l;if((a=a[0])&&this[0]){if(!(g=3===a.nodeType&&a)&&(f=a&&a.parentNode,g=f&&11===f.nodeType&&f.childNodes.length===this.length?f:B(a),l=g.firstChild,1===g.childNodes.length&&(g=l),!l))return this;l=0;for(f=this.length;f>l;l++)e.call(this[l],0==l?g:g.cloneNode(!0))}return this},ps:function(a,b,e){var f=this.constructor();return W(a)?Aa.apply(f,a):m(f,a),f.prevObject=this,f.context=this.context,"find"===b?f.selector=this.selector+(this.selector?" ":"")+e:b&&(f.selector=this.selector+"."+b+"("+e+")"),
      f}};z.make=function(a){if(this.length=a&&a.length||0,0!==this.length)for(var b=0,e=a.length;e>b;b++)this[b]=a[b];return this};z.toArray=function(){return ca.call(this,0)};z.get=function(a){return T(a)?0>a?this[this.length+a]:this[a]:this.toArray()};z.add=function(a,b){a="string"==typeof a?d(a,b):y(a&&a.nodeType?[a]:a);b=m(this.get(),a);return this.ps(k(a[0])||k(b[0])?b:G(b))};z.each=function(a){if(!O(a))return this;for(var b=0,e=this.length;e>b;b++)a.call(this[b],b,this[b]);return this};z.attr=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  b){var e=this[0];return Q(a)&&void 0===b?U(e,a):this.each(function(f){var g=this.nodeType;if(3!==g&&8!==g&&2!==g)if("object"==typeof a)for(var l in a)null===b?this.removeAttribute(a):this.setAttribute(l,a[l]);else this.setAttribute(a,O(b)?b.call(this,f,this.getAttribute(a)):b)})};z.removeAttr=function(a){return this.each(function(){1==this.nodeType&&this.removeAttribute(a)})};z.data=function(a,b){return void 0===b?K(this[0],a):this.each(function(){K(this,a,b)})};z.append=function(){return this.dm(arguments,
    !0,function(a){1===this.nodeType&&this.appendChild(a)})};z.prepend=function(){return this.dm(arguments,!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})};z.before=function(){return this[0]&&this[0].parentNode?this.dm(arguments,!1,function(a){this.parentNode.insertBefore(a,this)}):this};z.after=function(){return this[0]&&this[0].parentNode?this.dm(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)}):this};z.replaceWith=function(a){var b=this,e=O(a);return this.each(function(f){var g=
    this.nextSibling,l=this.parentNode,t=e?a.call(this,f,this):a;l&&11!=l.nodeType?(l.removeChild(this),g?d(g).before(t):d(l).append(t)):b[f]=d(t).clone()[0]})};z.hide=function(){return this.each(function(){"none"!=this.style.display&&(w(this,"display",this.style.display),this.style.display="none")})};z.show=function(){return this.each(function(){var a=this.style,b;if(!(b=w(this,"display"))){b=this.tagName;if(!qa[b]){var e=d("<"+b+">").appendTo(I.body),f=d.css&&d.css(e[0],"display")||e[0].style.display;
    e.remove();qa[b]=f}b=qa[b]}a.display=b})};z.toggle=function(){return this.each(function(){var a=d(this);d.Expr.hidden(this)?a.show():a.hide()})};z.eq=function(a){return-1===a?this.slice(a):this.slice(a,+a+1)};z.first=function(){return this.eq(0)};z.last=function(){return this.eq(-1)};z.slice=function(){return this.ps(ca.apply(this,arguments),"slice",ca.call(arguments).join(","))};z.map=function(a){return this.ps(M(this,function(b,e){return a.call(b,e,b)}))};z.find=function(a){var b,e=this;if(!Q(a))return d(a).filter(function(){E=
    0;for(b=e.length;b>E;E++)if(pa(e[E],this))return!0});var f,g,l,t=this.ps("","find",a),E=0;for(b=this.length;b>E;E++)if(f=t.length,m(t,d(a,this[E])),0===E)for(g=f;g<t.length;g++)for(l=0;f>l;l++)if(t[l]===t[g]){t.splice(g--,1);break}return t};z.not=function(a){return this.ps(u(this,a,!1),"not",a)};z.filter=function(a){return this.ps(u(this,a,!0),"filter",a)};z.indexOf=function(a){return n(this,a)};z.is=function(a){return 0<this.length&&0<d(this[0]).filter(a).length};z.remove=function(){for(var a,b=
    0;T(a=this[b]);b++)a.parentNode&&a.parentNode.removeChild(a);return this};z.closest=function(a,b){var e,f,g=[],l=0;for(e=this.length;e>l;l++)for(f=this[l];f;){if(0<H(a,[f]).length){g.push(f);break}if(f=f.parentNode,!f||!f.ownerDocument||f===b||11===f.nodeType)break}return g=1<g.length?G(g):g,this.ps(g,"closest",a)};z.val=function(a){return T(a)?this.each(function(){this.value=a}):this[0]&&this[0].value||""};z.html=function(a){return T(a)?this.each(function(){this.innerHTML=a}):this[0]&&this[0].innerHTML||
    ""};z.text=function(a){var b,e=this[0];return T(a)?this.empty().append((e&&e.ownerDocument||I).createTextNode(a)):e&&(b=e.nodeType)?1===b||9===b?Q(e.textContent)?e.textContent:e.innerText.replace(Ya,""):3===b||4===b?e.nodeValue:null:null};z.empty=function(){var a,b;for(a=0;T(b=this[a]);a++)for(;b.firstChild;)b.removeChild(b.firstChild);return this};z.addClass=function(a){var b,e,f;if(O(a))return this.each(function(aa){d(this).addClass(a.call(this,aa,this.className))});if(a&&Q(a)){var g=a.split(Fa),
    l=0;for(b=this.length;b>l;l++)if(e=this[l],e&&1===e.nodeType)if(e.className||1!==g.length){var t=" "+e.className+" ",E=0;for(f=g.length;f>E;E++)~t.indexOf(" "+g[E]+" ")||(t+=g[E]+" ");e.className=ra(t)}else e.className=a}return this};z.removeClass=function(a){var b,e,f;if(O(a))return this.each(function(aa){d(this).removeClass(a.call(this,aa,this.className))});if(a&&Q(a)||void 0===a){var g=(a||"").split(Fa),l=0;for(b=this.length;b>l;l++)if(e=this[l],1===e.nodeType&&e.className)if(a){var t=(" "+e.className+
    " ").replace(va," "),E=0;for(f=g.length;f>E;E++)t=t.replace(" "+g[E]+" "," ");e.className=ra(t)}else e.className=""}return this};z.hasClass=function(a){return r(this,a)};z.fadeIn=function(){this.each(function(){d(this).show()})};z.fadeOut=function(){this.each(function(){d(this).hide()})};z.serializeArray=function(){return this.map(function(){return this.elements?y(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Za.test(this.nodeName)||$a.test(this.type))}).map(function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       b){a=d(this).val();return null==a||W(a)?M(a,function(e){return{name:b.name,value:e.replace(Ga,"\r\n")}}):{name:b.name,value:a.replace(Ga,"\r\n")}}).get()};z.wrap=function(a){return this.each(function(){var b=d(d(a)[0].cloneNode(!1));d(this).before(b);b.append(d(this))})};z.prop=function(a,b){return T(b)?this.each(function(){this[a]=b}):this[0]&&this[0][a]};z.clone=function(){return d(this.map(function(){return this.cloneNode(!0)}))};z.toggleClass=function(a,b){return this.each(function(){var e=d(this);
    (T(b)?b:!e.hasClass(a))?e.addClass(a):e.removeClass(a)})};d.Expr={hidden:function(a){return"none"===(d.css&&d.css(a,"display")||a.style.display)},visible:function(a){return!d.Expr.hidden(a)}};d.hasClass=r;d.walk=x;d.$$=C;d.setQuery=function(a){d.query=function(b,e){return C(b,e,a||function(f,g){return g.querySelectorAll(f)})}};z=da.Sizzle||da.qwery;d.setQuery(z||function(a,b){return(b=b||I).querySelectorAll?y(b.querySelectorAll(a)):[]});d.loadScript=D;d.each=function(a,b,e){var f,g=0,l=a.length,t=
    void 0===l||O(a);if(e)if(t)for(f in a){if(!1===b.apply(a[f],e))break}else for(;l>g&&!1!==b.apply(a[g++],e););else if(t)for(f in a){if(!1===b.call(a[f],f,a[f]))break}else for(;l>g&&!1!==b.call(a[g],g,a[g++]););return a};d._each=F;d.filter=H;d._indexOf=n;d._defaults=function(a){return F(ca.call(arguments,1),function(b){for(var e in b)null==a[e]&&(a[e]=b[e])}),a};d._filter=function(a,b,e){var f=[];return null==a?f:La&&a.filter===La?a.filter(b,e):(F(a,function(g,l,t){b.call(e,g,l,t)&&(f[f.length]=g)}),
    f)};d.proxy=function(a,b){if("string"==typeof b){var e=a[b];b=a;a=e}if(O(a)){var f=ca.call(arguments,2);e=function(){return a.apply(b,f.concat(ca.call(arguments)))};return e.guid=a.guid=a.guid||e.guid||ua++,e}};d.dir=v;d.nth=A;d.sibling=R;d.grep=N;d.map=M;d.data=K;d.attrs=V;d.eqSI=function(a,b){return a&&b?a.toLowerCase()===b.toLowerCase():a==b};var ra=Ha?function(a){return null==a?"":Ha.call(a)}:function(a){return null==a?"":a.toString().replace(Ia,"").replace(Ja,"")};d.trim=ra;d.indexOf=d.inArray=
    function(a,b){if(!b)return-1;if(Ka)return Ka.call(b,a);for(var e=0,f=b.length;f>e;e++)if(b[e]===a)return e;return-1};F("Boolean Number String Function Array Date RegExp Object".split(" "),function(a){return za["[object "+a+"]"]=a.toLowerCase(),this});d.type=Z;d.isFunction=O;d.isArray=Array.isArray||W;d.isWindow=h;d.isNaN=function(a){return null==a||!Xa.test(a)||isNaN(a)};d.merge=m;d.extend=d.fn.extend=p;d.makeArray=y;d.htmlFrag=B;var ja=function(a,b,e){if(a===b)return e;for(a=a.nextSibling;a;){if(a===
    b)return-1;a=a.nextSibling}return 1};return pa=d.contains=ma.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:function(){return!1},na=ma.compareDocumentPosition?(pa=function(a,b){return!!(16&a.compareDocumentPosition(b))},function(a,b){return a===b?(ia=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:1:a.compareDocumentPosition?-1:1}):function(a,b){if(a===b)return ia=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;
    var e=[],f=[],g=a.parentNode,l=b.parentNode,t=g;if(g===l)return ja(a,b);if(!g)return-1;if(!l)return 1;for(;t;)e.unshift(t),t=t.parentNode;for(t=l;t;)f.unshift(t),t=t.parentNode;g=e.length;l=f.length;for(t=0;g>t&&l>t;t++)if(e[t]!==f[t])return ja(e[t],f[t]);return t===g?ja(a,f[t],-1):ja(e[t],b,1)},d.unique=G,F({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return v(a,"parentNode")},parentsUntil:function(a,b,e){return v(a,"parentNode",e)},next:function(a){return A(a,
      2,"nextSibling")},prev:function(a){return A(a,2,"previousSibling")},nextAll:function(a){return v(a,"nextSibling")},prevAll:function(a){return v(a,"previousSibling")},nextUntil:function(a,b,e){return v(a,"nextSibling",e)},prevUntil:function(a,b,e){return v(a,"previousSibling",e)},siblings:function(a){return R(a.parentNode.firstChild,a)},children:function(a){return R(a.firstChild)},contents:function(a){return"iframe"===a.nodeName?a.contentDocument||a.contentWindow["document "]:y(a.childNodes)}},function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 b){d.fn[b]=function(e,f){var g=M(this,a,e),l=ca.call(arguments);return Ua.test(b)||(f=e),Q(f)&&(g=y(H(f,g))),g=1<this.length&&!ab[b]?G(g):g,(1<this.length||Va.test(f))&&Wa.test(b)&&(g=g.reverse()),this.ps(g,b,l.join(","))}}),F({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after"},function(a,b){d.fn[b]=function(e){var f,g,l=[];e=d(e);if((f=1===this.length&&this[0].parentNode)&&11===f.nodeType&&1===f.childNodes.length&&1===e.length)return e[a](this[0]),this;f=0;for(g=e.length;g>
  f;f++){var t=(0<f?this.clone(!0):this).get();d(e[f])[a](t);l=l.concat(t)}return this.ps(l,b,e.selector)}}),function(){var a=document.createElement("div");a.style.display="none";a.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";a=a.getElementsByTagName("a")[0];d.support={boxModel:null,opacity:/^0.55$/.test(a.style.opacity),cssFloat:!!a.style.cssFloat};a=/(opera)(?:.*version)?[ \/]([\w.]+)/;var b=/(msie) ([\w.]+)/,e=/(mozilla)(?:.*? rv:([\w.]+))?/,
    f=navigator.userAgent.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(f)||a.exec(f)||b.exec(f)||0>f.indexOf("compatible")&&e.exec(f)||[];(d.browser={version:a[2]||"0"})[a[1]||""]=!0}(),d.scriptsLoaded=function(a){O(a)&&la.push(a)},d.loadAsync=Ca,z||I.querySelectorAll||Ca("http://cdnjs.cloudflare.com/ajax/libs/sizzle/1.4.4/sizzle.min.js",function(){d.setQuery(da.Sizzle||da.qwery)}),d.init=!1,d.onload=function(){if(!d.init)try{d.support.boxModel=oa();var a=0;F(Da,function(b){a++;D(b.url,function(){try{b.cb&&
  b.cb()}catch(e){}--a||Ea()})});d.init=!0;a||Ea()}catch(b){L(b)}},I.body&&!d.init&&setTimeout(d.onload,1),d.hook=function(a){ka.push(a)},d.plug=function(a,b){Q(a);if(b=O(a)?a:b,!O(b))throw"Plugin fn required";b(d)},d}(),P=jquip,P.plug("css",function(c){function d(h,q,m){var p="width"===q?h.offsetWidth:h.offsetHeight;q="width"===q?V:Z;return 0<p?("border"!==m&&c.each(q,function(){m||(p-=parseFloat(u(h,"padding"+this))||0);"margin"===m?p+=parseFloat(u(h,m+this))||0:p-=parseFloat(u(h,"border"+this+"Width"))||
  0}),p+"px"):""}function k(h,q,m,p){if(h&&3!==h.nodeType&&8!==h.nodeType&&h.style){var y,B=r(q),S=h.style,G=c.cssHooks[B];if(q=c.cssProps[B]||B,void 0===m)return G&&"get"in G&&void 0!==(y=G.get(h,!1,p))?y:S[q];if(!("number"==typeof m&&isNaN(m)||null==m||("number"!=typeof m||c.cssNumber[B]||(m+="px"),G&&"set"in G&&void 0===(m=G.set(h,m)))))try{S[q]=m}catch(oa){}}}function u(h,q,m){var p,y=r(q),B=c.cssHooks[y];return q=c.cssProps[y]||y,B&&"get"in B&&void 0!==(p=B.get(h,!0,m))?p:Q?Q(h,q,y):void 0}function w(h,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               q,m){var p,y={};for(p in q)y[p]=h.style[p],h.style[p]=q[p];m.call(h);for(p in q)h.style[p]=y[p]}function r(h){return h.replace(v,T)}function x(h,q,m,p,y,B){var S=h.length;if("object"==typeof q){for(var G in q)x(h,G,q[G],p,y,m);return h}if(void 0!==m){p=!B&&p&&c.isFunction(m);for(G=0;S>G;G++)y(h[G],q,p?m.call(h[G],G,y(h[G],q)):m,B);return h}return S?y(h[0],q):void 0}function C(h){return c.isWindow(h)?h:9===h.nodeType?h.defaultView||h.parentWindow:!1}var D,L,F=document,U=F.documentElement,H=/alpha\([^)]*\)/i,
  n=/opacity=([^)]*)/,v=/-([a-z])/gi,A=/([A-Z])/g,R=/^-?\d+(?:px)?$/i,N=/^-?\d/,M=/^(?:body|html)$/i,K={position:"absolute",visibility:"hidden",display:"block"},V=["Left","Right"],Z=["Top","Bottom"],T=function(h,q){return q.toUpperCase()};c.cssHooks={opacity:{get:function(h,q){if(!q)return h.style.opacity;h=Q(h,"opacity","opacity");return""===h?"1":h}}};c._each(["height","width"],function(h){c.cssHooks[h]={get:function(q,m,p){var y;return m?0!==q.offsetWidth?d(q,h,p):(w(q,K,function(){y=d(q,h,p)}),
    y):void 0},set:function(q,m){return R.test(m)?(m=parseFloat(m),0<=m?m+"px":void 0):m}}});c.support.opacity||(c.support.opacity={get:function(h,q){return n.test((q&&h.currentStyle?h.currentStyle.filter:h.style.filter)||"")?parseFloat(RegExp.$1)/100+"":q?"1":""},set:function(h,q){h=h.style;h.zoom=1;q=c.isNaN(q)?"":"alpha(opacity="+100*q+")";var m=h.filter||"";h.filter=H.test(m)?m.replace(H,q):h.filter+" "+q}});F.defaultView&&F.defaultView.getComputedStyle&&(D=function(h,q,m){var p,y,B;return m=m.replace(A,
  "-$1").toLowerCase(),(y=h.ownerDocument.defaultView)?((B=y.getComputedStyle(h,null))&&(p=B.getPropertyValue(m),""!==p||c.contains(h.ownerDocument.documentElement,h)||(p=c.style(h,m))),p):void 0});F.documentElement.currentStyle&&(L=function(h,q){var m,p=h.currentStyle&&h.currentStyle[q],y=h.runtimeStyle&&h.runtimeStyle[q],B=h.style;return!R.test(p)&&N.test(p)&&(m=B.left,y&&(h.runtimeStyle.left=h.currentStyle.left),B.left="fontSize"===q?"1em":p||0,p=B.pixelLeft+"px",B.left=m,y&&(h.runtimeStyle.left=
  y)),""===p?"auto":p});var Q=D||L;c.fn.css=function(h,q){return 2===arguments.length&&void 0===q?this:x(this,h,q,!0,function(m,p,y){return void 0!==y?k(m,p,y):u(m,p)})};c.cssNumber={zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0};c.cssProps={"float":c.support.cssFloat?"cssFloat":"styleFloat"};c.style=k;c.css=u;c.swap=w;c.camelCase=r;var O,W;c.fn.offset=function(){var h=this[0];if(!h||!h.ownerDocument)return null;if(h===h.ownerDocument.body){var q=h.offsetTop,m=h.offsetLeft;if(!O){var p=F.body,
  y=F.createElement("div"),B=parseFloat(u(p,"marginTop"))||0;c.extend(y.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});y.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";p.insertBefore(y,p.firstChild);
  var S=y.firstChild,G=S.firstChild;G.style.position=G.style.top="";S.style.overflow="hidden";S.style.position="relative";W=p.offsetTop!==B;p.removeChild(y);O=!0}return W&&(q+=parseFloat(u(h,"marginTop"))||0,m+=parseFloat(u(h,"marginLeft"))||0),{top:q,left:m}}try{q=h.getBoundingClientRect()}catch(oa){}if(!q||!c.contains(U,h))return q?{top:q.top,left:q.left}:{top:0,left:0};h=F.body;m=C(F);return{top:q.top+(m.pageYOffset||c.support.boxModel&&U.scrollTop||h.scrollTop)-(U.clientTop||h.clientTop||0),left:q.left+
    (m.pageXOffset||c.support.boxModel&&U.scrollLeft||h.scrollLeft)-(U.clientLeft||h.clientLeft||0)}};c.fn.position=function(){if(!this[0])return null;var h=this[0],q=this.offsetParent(),m=this.offset(),p=M.test(q[0].nodeName)?{top:0,left:0}:q.offset();return m.top-=parseFloat(u(h,"marginTop"))||0,m.left-=parseFloat(u(h,"marginLeft"))||0,p.top+=parseFloat(u(q[0],"borderTopWidth"))||0,p.left+=parseFloat(u(q[0],"borderLeftWidth"))||0,{top:m.top-p.top,left:m.left-p.left}};c.fn.offsetParent=function(){return this.map(function(){for(var h=
  this.offsetParent||F.body;h&&!M.test(h.nodeName)&&"static"===u(h,"position");)h=h.offsetParent;return h})};c._each(["Height","Width"],function(h){var q=h.toLowerCase();c.fn["inner"+h]=function(){var m=this[0];return m&&m.style?parseFloat(u(m,q,"padding")):null};c.fn["outer"+h]=function(m){var p=this[0];return p&&p.style?parseFloat(u(p,q,m?"margin":"border")):null};c.fn[q]=function(m){var p=this[0];if(!p)return null==m?null:this;if(c.isFunction(m))return this.each(function(S){var G=c(this);G[q](m.call(this,
  S,G[q]()))});if(c.isWindow(p)){var y=p.document.documentElement["client"+h],B=p.document.body;return"CSS1Compat"===p.document.compatMode&&y||B&&B["client"+h]||y}return 9===p.nodeType?Math.max(p.documentElement["client"+h],p.body["scroll"+h],p.documentElement["scroll"+h],p.body["offset"+h],p.documentElement["offset"+h]):void 0===m?(p=u(p,q),y=parseFloat(p),c.isNaN(y)?p:y):this.css(q,"string"==typeof m?m:m+"px")}});c._each(["Left","Top"],function(h,q){var m="scroll"+h;c.fn[m]=function(p){var y,B;return void 0===
p?(y=this[0])?(B=C(y),B?"pageXOffset"in B?B[q?"pageYOffset":"pageXOffset"]:c.support.boxModel&&B.document.documentElement[m]||B.document.body[m]:y[m]):null:this.each(function(){(B=C(this))?B.scrollTo(q?c(B).scrollLeft():p,q?p:c(B).scrollTop()):this[m]=p})}})}),P.plug("events",function(c){function d(n,v,A){n.addEventListener?n.addEventListener(v,A,!1):(n["e"+v+A]=A,n[v+A]=function(){n["e"+v+A](window.event)},n.attachEvent("on"+v,n[v+A]))}function k(n,v,A){n.removeEventListener?n.removeEventListener(v,
  A,!1):(n.detachEvent("on"+v,n[v+A]),n[v+A]=null)}function u(n){n=(""+n).split(".");return{e:n[0],ns:n.slice(1).sort().join(" ")}}function w(n,v,A,R){if(v=u(v),v.ns)var N=new RegExp("(?:^| )"+v.ns.replace(" "," .* ?")+"(?: |$)");return c._filter(L[n._jquid||(n._jquid=F++)]||[],function(M){return!(!M||v.e&&M.e!=v.e||v.ns&&!N.test(M.ns)||A&&M.fn!=A||R&&M.sel!=R)})}function r(n,v,A,R,N){var M=n._jquid||(n._jquid=F++),K=L[M]||(L[M]=[]);c._each(v.split(/\s/),function(V){V=c.extend(u(V),{fn:A,sel:R,del:N,
  i:K.length});K.push(V);d(n,V.e,N||A)});n=null}function x(n,v,A,R){var N=n._jquid||(n._jquid=F++);c._each((v||"").split(/\s/),function(M){c._each(w(n,M,A,R),function(K){delete L[N][K.i];k(n,K.e,K.del||K.fn)})})}function C(n){var v=c.extend({originalEvent:n},n);return c._each(U,function(A){n[A]&&(v[A]=function(){return n[A].apply(n,arguments)})}),v}var D=document,L={},F=1;c.bind=d;c.unbind=k;var U=["preventDefault","stopImmediatePropagation","stopPropagation"],H=c.fn;c._each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),
  function(n){H[n]=function(v,A){return 0<arguments.length?this.bind(n,v,A):this.trigger(n)}});H.bind=function(n,v){return this.each(function(){r(this,n,v)})};H.unbind=function(n,v){return this.each(function(){x(this,n,v)})};H.one=function(n,v){return this.each(function(){var A=this;r(this,n,function(){v.apply(A,arguments);x(A,n,arguments.callee)})})};H.delegate=function(n,v,A){return this.each(function(R,N){r(N,v,A,n,function(M){for(var K=M.target||M.srcElement,V=c.$$(n,N);K&&0>c._indexOf(V,K);)K=
  K.parentNode;K&&K!==N&&K!==document&&A.call(K,c.extend(C(M||window.event),{currentTarget:K,liveFired:N}))})})};H.undelegate=function(n,v,A){return this.each(function(){x(this,v,A,n)})};H.live=function(n,v){return c(D.body).delegate(this.selector,n,v),this};H.die=function(n,v){return c(D.body).undelegate(this.selector,n,v),this};H.on=function(n,v,A){return"function"==typeof v?this.bind(n,v):this.delegate(v,n,A)};H.off=function(n,v,A){return"string"==typeof v?this.undelegate(v,n,A):this.unbind(n,A)};
  H.trigger=function(n){return this.each(function(){if(("click"==n||"blur"==n||"focus"==n)&&this[n])return this[n]();if(D.createEvent){var v=D.createEvent("Events");this.dispatchEvent(v,v.initEvent(n,!0,!0))}else if(this.fireEvent)try{"ready"!==n&&this.fireEvent("on"+n)}catch(A){}})};c.init||c(window).bind("load",c.onload)}));X.prototype.draw=function(c,d,k){c="undefined"===typeof c?1:parseFloat(c);d="undefined"===typeof d?1:parseFloat(d);c=0<c?c:1;d=0<d?d:1;var u=this.lineConfig,w=("undefined"===typeof k?
  0:k)?this.ctxBack:this.ctx;w.beginPath();for(var r in u)w[r]=u[r];w.lineWidth=u.lineWidth*Math.min(c,d);1==this.points.length?(k=this.points[0],w.moveTo(k.x*c,k.y*d),w.lineTo(k.x*c,k.y*d),w.stroke()):this.points.forEach(function(x,C){w[0<C?"lineTo":"moveTo"](x.x*c,x.y*d);0<C&&w.stroke()})};X.prototype.addPoint=function(c,d){this.points.push({x:c,y:d})};Y.prototype.exec=function(){var c=this,d=this.tablet,k=this.tablet.ctxBack,u=function(r){console.log("\u753b\u7ebf");r="undefined"==typeof r?!1:!!r;
  c.lines.forEach(function(x){x&&x.draw(d.widthZoomRate,d.heightZoomRate,r)})},w=function(r){"color"==r.bgType?d.setBackgroundColor(r.bgColor,r.x,r.y,r.width,r.height,!1):"img"==r.bgType&&d.setBackgroundImage(r.bgImg,r.x,r.y,r.width,r.height,null,null,!1)};switch(this.type){case "drawLine":k.clearRect(0,0,d.width,d.height);u(!0);w(c.bgConfig);break;case "bgColor":case "bgImg":k.clearRect(0,0,d.width,d.height),u(!0),w(c.bgConfig)}};J._conut=0;J.prototype._init=function(c,d){c=P(c);if(0==c.length)throw"\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u5305\u88f9\u753b\u5e03\u7684\u9009\u62e9\u5668\u6216dom\u5143\u7d20\uff01";
  c=c.eq(0);this.config={response:!0,width:0,height:0,extraClass:"",defaultColor:"#000",defaultBackgroundColor:"transparent",defaultBgType:"color",defaultBgImg:null,defaultHeight:400,autoResize:!0,imgType:"png",onInit:function(){},onBeforeClear:function(){},onClear:function(){}};d&&"[object Object]"==={}.toString.call(d)&&P.extend(!0,this.config,d);this.container=c;this.id="Tablet_LYN_"+J._conut++;this.isMobile=/phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone/i.test(navigator.userAgent);
  this.lineConfig={strokeStyle:this.config.defaultColor,lineWidth:8,lineWidthZoomRate:1,lineCap:"round",lineJoin:"round",shadowBlur:1,shadowColor:this.config.defaultColor};this.bgConfig={bgColor:this.config.defaultBackgroundColor,bgImg:this.config.bgImg,bgType:this.config.bgType,x:0,y:0,width:-1,height:-1};this.container.append(P(this.buildTablet()));this.$tablet=P("#"+this.id);this.$canvas=this.$tablet.find("canvas").eq(0);this.canvas=this.$canvas[0];this.ctx=this.canvas.getContext("2d");this.$canvasBack=
    this.$tablet.find(".backup-canvas");this.$canvasBack.hide();this.canvasBack=this.$canvasBack[0];this.ctxBack=this.canvasBack.getContext("2d");this.point={x:0,y:0};this.lines=[];this.operationRecords=[];this.degree=0;this.version="2.0.1";this.width="function"===typeof this.config.width?this.config.width():this.config.width;this.height="function"===typeof this.config.height?this.config.height():this.config.height;this.setCanvasWH(this.width,this.height);this.widthOrigin=this.width;this.heightOrigin=
    this.height;this.heightZoomRate=this.widthZoomRate=1;this.config.autoResize&&(this._removeResizeEventFn=this._bindResizeEvent());d=P(window).width();this.isMobile&&(768<=d?this.lineConfig.lineWidth=8:768>d&&414<=d?this.lineConfig.lineWidth=6:414>d&&375<=d?this.lineConfig.lineWidth=4:375>d&&320<=d&&(this.lineConfig.lineWidth=2));this.config.onInit&&"function"===typeof this.config.onInit&&this.config.onInit.call(this)};J.prototype._ctxInit=function(){var c=this;this.pressed=!1;var d=function(x){return function(C){C.preventDefault();
  1===x&&(c.pressed=!0);if(1===x||c.pressed){C=c.isMobile?C.touches[0]:C;var D=c.$canvas.offset(),L=P(document.documentElement).scrollTop(),F=P(document.documentElement).scrollLeft();c.point.x=C.clientX-(D.left+.5-F);c.point.y=C.clientY-(D.top+.5-L);switch(x){case 1:c.ctx.beginPath(),c.ctx.moveTo(c.point.x,c.point.y),c.lines.push(new X(c.ctx,c.ctxBack,P.extend({},c.lineConfig),P.extend({},c.bgConfig)));case 2:c.ctx.lineWidth=c.lineConfig.lineWidth*c.lineConfig.lineWidthZoomRate,c.ctx.lineTo(c.point.x,
    c.point.y),c.ctx.stroke(),c.lines[c.lines.length-1].addPoint(c.point.x/c.widthZoomRate,c.point.y/c.heightZoomRate)}}}},k=c.lineConfig,u;for(u in k)c.ctx[u]=k[u],c.ctxBack[u]=k[u];c.isMobile||(c.ctx.shadowBlur=k.shadowBlur,c.ctx.shadowColor=k.shadowColor,c.ctxBack.shadowBlur=k.shadowBlur,c.ctxBack.shadowColor=k.shadowColor);k=d(1);d=d(2);var w=function(){c.pressed=!1;0<c.lines.length&&c.lines[c.lines.length-1]&&c.lines[c.lines.length-1].draw(0,0,!0)},r=function(){0<c.lines.length&&(console.log("addOperationRecord drawLine"),
  c.operationRecords.push(new Y({type:"drawLine",tablet:c,lines:c.lines,bgConfig:c.bgConfig,linesIndex:c.lines.length-1})))};(function(x){"color"==x.bgType?c.setBackgroundColor(x.bgColor,-1,-1,-1,-1,!1):"img"==x.bgType&&c.setBackgroundImage(x.bgImg,-1,-1,-1,-1,null,null,!1)})({bgType:this.config.defaultBgType,bgColor:this.config.defaultBackgroundColor,bgImg:this.config.defaultBgImg});this.isMobile?(this.$canvas.on("touchstart",k),this.$canvas.on("touchmove",d)):(this.$canvas.on("mousedown",k),this.$canvas.on("mousemove",
  d));["touchend","mouseleave","mouseup"].forEach(function(x,C){c.$canvas.on(x,w)});["touchend","mouseup"].forEach(function(x,C){c.$canvas.on(x,r)})};J.prototype._bindResizeEvent=function(){var c="resize",d=this,k=0,u=this.width;c+=window.onorientationchange?" orientationchange":"";console.log("resize event");var w=function(){var r=(new Date).getTime();if(0==k||100<r-k){k=r;r=d.$tablet;var x=parseFloat(r.css("border-left-width")),C=parseFloat(r.css("border-right-width"));parseFloat(r.css("border-top-width"));
  parseFloat(r.css("border-bottom-width"));var D=parseFloat(r.css("padding-left")),L=parseFloat(r.css("padding-right"));parseFloat(r.css("padding-top"));parseFloat(r.css("padding-bottom"));x=r.width()-x-C-D-L;r.height();u==x?console.info("container width not changed!"):(u=x,d.setCanvasWH(),d.refresh())}};P(window).on(c,w);return function(){P(window).off(c,w)}};J.prototype.refresh=function(c){var d=this;("undefined"==typeof c?0:c)&&this.setCanvasWH();var k=d.width/d.widthOrigin,u=d.height/d.heightOrigin,
  w=d.bgConfig;c=function(){console.log("\u91cd\u7ed8\u80cc\u666f\uff01");"color"==w.bgType?d.setBackgroundColor(w.bgColor,w.x,w.y,w.width,w.height,!1):"img"==w.bgType&&d.setBackgroundImage(w.bgImg,w.x,w.y,w.width,w.height,null,null,!1)};d.lineConfig.lineWidthZoomRate=Math.min(k,u);d.widthZoomRate=k;d.heightZoomRate=u;console.log("rate",Math.min(k,u));var r=d.hasCanUseLine();console.log("\u6709\u53ef\u7528\u7ebf\u6761",r);if(r)if(d.ctxBack.clearRect(0,0,d.width,d.height),d.lines.forEach(function(x){x&&
x.draw(k,u,!0)}),d.ctx.clearRect(0,0,d.width,d.height),"color"==w.bgType&&"transparent"==w.bgColor)d.ctx.drawImage(d.canvasBack,0,0);else return c(),this;else d.canvasReset(),c()};J.prototype.getRect=function(){var c=this.width,d=this.height;if(90==this.degree||-90==this.degree)c=this.height,d=this.width;var k=this.$canvas.offset();return{x:k.left,y:k.top,width:c,height:d}};J.prototype.hasCanUseLine=function(){return this.lines.some(function(c){return!!c})};J.prototype.setColor=function(c){this.ctx.beginPath();
  if(!c)return console.error("color is required!"),this;this.lineConfig.strokeStyle=c;this.ctx.strokeStyle=c;this.ctxBack.strokeStyle=c;this.isMobile||(this.lineConfig.shadowColor=c,this.ctx.shadowColor=c,this.ctxBack.shadowColor=c);return this};J.prototype.setLineWidth=function(c){c=parseFloat(c);if(isNaN(c))return console.error("number is required a Number!"),this;this.lineConfig.lineWidth=c;this.ctx.beginPath();this.ctxBack.beginPath();this.ctx.lineWidth=c;this.ctxBack.lineWidth=c;return this};J.prototype.setBackgroundColor=
  function(c,d,k,u,w,r){var x=this.getRect();d=d||0;k=k||0;var C=0<u?u:x.width;x=0<w?w:x.height;this.bgConfig.bgType="color";this.bgConfig.bgColor=c;this.bgConfig.bgImg=null;this.bgConfig.x=d;this.bgConfig.y=k;this.bgConfig.width=u;this.bgConfig.height=w;this.ctx.clearRect(d,k,C,x);this.ctx.fillStyle=c;this.ctx.fillRect(d,k,C,x);this.hasCanUseLine()&&this.ctx.drawImage(this.canvasBack,d,k,C,C,d,k,C,C);"undefined"==typeof r&&(console.log("addOperationRecord bgColor"),this.operationRecords.push(new Y({type:"bgColor",
    tablet:this,lines:this.lines,bgConfig:this.bgConfig})));return this};J.prototype.setBackgroundImage=function(c,d,k,u,w,r,x,C){if(!c)return console.error("setBackgroundImage\u51fd\u6570\u5fc5\u987b\u4f20\u9012\u4e00\u4e2a\u56fe\u7247url\u5730\u5740\u6216\u56fe\u7247dom\u5bf9\u8c61\uff01"),!1;var D=this,L=function(){var H=D.getRect();d=d||0;k=k||0;var n=0<u?u:H.width;H=0<w?w:H.height;D.bgConfig.bgType="img";D.bgConfig.bgImg=c;D.bgConfig.bgColor="";D.bgConfig.x=d;D.bgConfig.y=k;D.bgConfig.width=u;D.bgConfig.height=
  w;"function"===typeof r&&r({statusCode:2,status:"ok",img:c});D.ctx.clearRect(d,k,n,H);D.ctx.drawImage(c,d,k,n,H);D.ctx.drawImage(D.canvasBack,d,k,n,H,d,k,n,H);if(C="undefined"==typeof C?!0:!1)console.log("addOperationRecord bgImg"),D.operationRecords.push(new Y({type:"bgImg",tablet:D,lines:D.lines,bgConfig:D.bgConfig}));console.log("\u56fe\u7247\u7ed8\u5236\u5b8c\u6210")},F=function(){console.error("\u56fe\u7247\u52a0\u8f7d\u5931\u8d25,\u4e0d\u80fd\u8fdb\u884c\u7ed8\u5236");"function"===typeof x&&
x()};if("string"==typeof c){"function"===typeof r&&r({statusCode:1,status:"loading"});var U=c;c=new Image;c.onload=L;c.onerror=F;c.src=U}else c.complete?L():(c.onload=L,c.onerror=F)};J.prototype.setCanvasWH=function(c,d){if(c&&d)this.width=c,this.height=d;else{c=this.$tablet;d=parseFloat(c.css("border-left-width"));var k=parseFloat(c.css("border-right-width")),u=parseFloat(c.css("border-top-width")),w=parseFloat(c.css("border-bottom-width")),r=parseFloat(c.css("padding-left")),x=parseFloat(c.css("padding-right")),
  C=parseFloat(c.css("padding-top")),D=parseFloat(c.css("padding-bottom"));this.width=c.width()-d-k-r-x;this.height=c.height()-u-w-C-D;0>=this.width&&(this.width=this.container.width());0>=this.height&&(this.height=this.container.height(),0>=this.height&&(this.height=this.config.defaultHeight))}this.$canvas.css("display","block");c=this.lineConfig;(d=this.devicePixelRatio=window.devicePixelRatio||1,1<d)?(k=this.width*d,u=this.height*d,this.$canvas.width(this.width),this.$canvas.height(this.height),
  this.$canvasBack.width(this.width),this.$canvasBack.height(this.height),this.canvas.width=k,this.canvas.height=u,this.canvasBack.width=k,this.canvasBack.height=u,this.ctx.scale(d,d),this.ctxBack.scale(d,d),this.ctx.clearRect(0,0,k,u),this.ctxBack.clearRect(0,0,k,u)):(this.canvas.width=this.width,this.canvas.height=this.height,this.canvasBack.width=this.width,this.canvasBack.height=this.height,this.ctx.clearRect(0,0,this.width,this.height),this.ctxBack.clearRect(0,0,this.width,this.height));for(var L in c)this.ctx[L]=
  c[L],this.ctxBack[L]=c[L];return this};J.prototype.canvasReset=function(){var c=this.lineConfig,d;for(d in c)this.ctx[d]=c[d],this.ctxBack[d]=c[d];this.isMobile||(this.ctx.shadowBlur=c.shadowBlur,this.ctx.shadowColor=c.shadowColor,this.ctxBack.shadowBlur=c.shadowBlur,this.ctxBack.shadowColor=c.shadowColor);return this};J.prototype.revoke=function(){var c=this.operationRecords;if(0==c.length)return this;var d=c.length-1,k=c.splice(d,1);console.log("step",d,k[0],k[0].linesIndex);-1<k[0].linesIndex&&
this.removeLine(k[0].linesIndex);if(0==c.length)return this.ctx.clearRect(0,0,this.width,this.height),this.ctxBack.clearRect(0,0,this.width,this.height),c=this.config.defaultBgType,d=this.config.defaultBackgroundColor,k=this.config.defaultBgImg,"color"==c?this.setBackgroundColor(d,-1,-1,-1,-1,!1):"img"==c&&this.setBackgroundImage(k,-1,-1,-1,-1,null,null,!1),this;c[d-1].exec();return this};J.prototype.clear=function(c){var d=this.width,k=this.height;c="undefined"===typeof c?!1:!!c;if(!this.config.onBeforeClear||
  "function"!==typeof this.config.onBeforeClear||!1!==this.config.onBeforeClear.call(this)){if(90==this.degree||-90==this.degree)d=this.height,k=this.width;this.ctx.clearRect(0,0,d,k);this.ctxBack.clearRect(0,0,d,k);c&&(this.operationRecords=[],this.lines=[]);this.config.onClear&&"function"===typeof this.config.onClear&&this.config.onClear.call(this);return this}};J.prototype.removeLine=function(c){var d=this.lines;console.log("indexOrLine",c);if("number"==typeof c)d.splice(c,1,null),console.log("lines",
  d);else if("object"==typeof c){for(var k=-1,u=0,w=d.length;u<w;u++)if(d[u]==c){k=u;break}d.splice(k,1,null)}return this};J.prototype.getBase64=function(c,d){if(c){var k=c.toLowerCase();if("png"===k)c="image/png";else if("jpg"===k||"jpeg"===k)c="image/jpg"}else c="image/png";if(d){k=this.width;var u=this.height,w=this.devicePixelRatio;w&&1<w&&(k*=w,u*=w);-90===d&&(d=270);w=d*Math.PI/180;d=d/90%4;var r=document.createElement("canvas"),x=r.getContext("2d");0===d?(r.width=k,r.height=u,x.drawImage(this.canvas,
  0,0)):1===d?(r.width=u,r.height=k,x.translate(.5*r.width,.5*r.height),x.rotate(w),x.drawImage(this.canvas,-r.height/2,-r.width/2)):2===d?(r.width=k,r.height=u,x.translate(.5*k,.5*u),x.rotate(w),x.drawImage(this.canvas,-r.width/2,-r.height/2)):3===d&&(r.width=u,r.height=k,x.translate(.5*r.width,.5*r.height),x.rotate(w),x.drawImage(this.canvas,-r.height/2,-r.width/2));c=r.toDataURL(c,1)}else c=this.canvas.toDataURL(c,1);return c};J.prototype.getBlob=function(c,d){d=this.getBase64(c,d).split(",");c=
  d[0].match(/:(.*?);/)[1];d=atob(d[1]);for(var k=d.length,u=new Uint8Array(k);k--;)u[k]=d.charCodeAt(k);return new Blob([u],{type:c})};J.prototype.buildTablet=function(){return'<div class="-tablet '+this.config.extraClass+'" id="'+this.id+'">    <div class="-canvas-wrapper">        <canvas class="tablet-canvas" style="cursor: crosshair;display: none;"></canvas>        <canvas class="backup-canvas"></canvas>    </div></div>'};J.getMax=function(c,d){var k={left:0,right:0,top:0,bottom:0};if("[object Array]"!==
  {}.toString.call(c)||"[object Array]"!=={}.toString.call(d))return k;k.left=Math.min.apply(null,c);k.right=Math.max.apply(null,c);k.top=Math.min.apply(null,d);k.bottom=Math.max.apply(null,d);return k};J.prototype.destroy=function(){this.$canvas.css("cursor","default");this.$canvas.off();this.$canvasBack.off();this.container=this.$tablet=this.ctxBack=this.$canvasBack=this.canvasBack=this.ctx=this.$canvas=this.canvas=null;this.lines=[];this.operationRecords=[];"function"===typeof this._removeResizeEventFn&&
(this._removeResizeEventFn(),this._removeResizeEventFn=null)};return J});
